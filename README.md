InfoSec Log Monitoring System
=============================

Проект для тестирования систем безопасности с помощью симуляции логов обычной активности и атак.
Состоит из сервера, нескольких клиентов-генераторов логов и админской консоли для мониторинга угроз в реальном времени

---

Требования
----------
- Python 3.10+
- Docker & Docker Compose
- SQLite3 (используется внутри контейнера)
- pip-пакеты: Flask, requests, PyJWT

---

Настройка и запуск проекта
--------------------------

1. Сборка Docker-контейнеров:

docker-compose build

> Убедись, что предыдущие контейнеры остановлены, чтобы избежать конфликтов IP:
docker-compose down --remove-orphans

2. Запуск проекта:

docker-compose up

- server — Flask сервер на 0.0.0.0:8000  
- client1, client2, client3 — генераторы логов с разными MAC/IP  

> Каждый клиент автоматически генерирует логи и отправляет их на сервер каждые 1-2 секунды.

---

Админская CLI-консоль
--------------------

Подключение к контейнеру сервера:

docker exec -it server python /server/admin/cli.py

Основные команды:

help                - показать справку
stats               - показать количество всех логов, угроз и клиентов
threats [N]         - показать последние N угроз (по умолчанию 10)
logs [user <name>]  - показать последние логи, фильтровать по пользователю
logs [ip <ip>]      - показать логи с определённого IP
attack-types        - показать список всех типов атак
clients             - список всех клиентов (MAC + ID)
watch               - включить слежку за новыми угрозами в реальном времени
stop                - остановить слежку
exit                - выйти из CLI

---

Конфигурация
------------

Сервер (server/config.py):

- JWT_SECRET — секрет для создания JWT
- AUTHORIZED_MACS — список MAC-адресов разрешённых клиентов
- THREAT_KEYWORDS — ключевые слова для обнаружения угроз
- DB_PATH — путь к базе данных SQLite3 (db.sqlite3)

Клиент (client/config.py):

- CLIENT_ID — уникальный идентификатор клиента
- MAC_ADDRESS — MAC-адрес клиента
- SERVER_URL — адрес сервера
- LOG_DIR — папка с логами
- LOG_ENDPOINT — API сервера для логов
- USERNAMES — список пользователей для генерации логов
- SEND_INTERVAL — интервал отправки логов на сервер

> В docker-compose.yml можно задать IP клиентов и сервера, чтобы включить фильтрацию по IP в auth_middleware.py.

---

Генерация логов
---------------

- Логи генерируются клиентом автоматически в LOG_DIR.
- Содержат как обычные действия пользователя, так и атаки.
- Шанс генерации атаки по умолчанию 7%.
- Каждая строка содержит timestamp, имя пользователя, IP и описание события.

---

База данных
-----------

- db.sqlite3 (SQLite3)
- Таблицы:
  - logs — все логи
  - threats — только обнаруженные угрозы
- Каждая запись содержит: timestamp, client_id, mac, ip, level, message

---

Docker-сеть
------------

- Сервер и клиенты работают в отдельной внутренней сети Docker.
- Разрешены только IP, указанные в конфигурации.
- Можно протестировать с разными MAC и IP для каждого клиента.

---

Примечания
-----------

- Если клиент не может аутентифицироваться, он повторяет попытку каждые 2 секунды.
- Админская консоль watch выводит новые угрозы в реальном времени.
- CLI поддерживает фильтрацию логов по пользователю и IP.

---

